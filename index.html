<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Deive AbraÃ£o - Mobile Edition</title>
    <style>
        body {
            margin: 0; padding: 0;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            height: 100vh; background-color: #000;
            font-family: 'Arial', sans-serif; color: white;
            overflow: hidden; touch-action: none;
        }
        canvas {
            background-color: #4682B4;
            max-width: 100%; height: auto;
            border: 2px solid #333;
            display: block;
        }
        #controls {
            display: flex; flex-direction: column;
            width: 100%; max-width: 800px;
            background: #111; padding: 15px;
            box-sizing: border-box;
        }
        .row { display: flex; justify-content: center; gap: 10px; margin-bottom: 8px; }
        .btn {
            background: #2a2a2a; border: 2px solid #444;
            color: white; padding: 18px;
            text-align: center; border-radius: 12px;
            flex: 1; font-weight: bold; font-size: 18px;
            user-select: none; -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        .btn:active { background: #555; transform: scale(0.95); }
        .btn-jump { background: #0084ff; border-color: #00d4ff; flex: 2; }
        .btn-shoot { background: #ff4757; border-color: #ff6b81; flex: 1.5; }
        .btn-dir { background: #333; font-size: 22px; }
    </style>
</head>
<body>

    <canvas id="gameCanvas"></canvas>

    <div id="controls">
        <div class="row">
            <div class="btn btn-jump" id="btnJump">PULAR / REINICIAR</div>
            <div class="btn btn-shoot" id="btnShoot">ATIRAR</div>
        </div>
        <div class="row">
            <div class="btn btn-dir" id="btnLeft">â—€</div>
            <div class="btn btn-dir" id="btnUp">â–²</div>
            <div class="btn btn-dir" id="btnDown">â–¼</div>
            <div class="btn btn-dir" id="btnRight">â–¶</div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        canvas.width = 800;
        canvas.height = 400;

        let score = 0;
        let kills = 0;
        let gameActive = true;
        let gameWon = false;
        let frames = 0;
        let flightMode = false;
        let timeRemaining = 10;
        
        const moveState = { Up: false, Down: false, Left: false, Right: false };

        const deive = {
            x: 80, y: 300, width: 40, height: 90,
            dy: 0, jumpForce: 13, gravity: 0.65, grounded: false, speed: 7,
            draw() {
                const skin = "#FFDBAC";
                ctx.fillStyle = "#000"; ctx.fillRect(this.x + 5, this.y, 30, 10);
                ctx.fillStyle = skin; ctx.fillRect(this.x + 5, this.y + 5, 30, 25);
                ctx.fillStyle = "white"; ctx.fillRect(this.x + 10, this.y + 12, 6, 6); ctx.fillRect(this.x + 24, this.y + 12, 6, 6);
                ctx.fillStyle = "black"; ctx.fillRect(this.x + 12, this.y + 14, 3, 3); ctx.fillRect(this.x + 26, this.y + 14, 3, 3);
                ctx.fillStyle = "#800000"; ctx.fillRect(this.x + 15, this.y + 24, 10, 2);
                ctx.fillStyle = "#0000FF"; ctx.fillRect(this.x + 8, this.y + 30, 24, 25);
                const colors = ["#ff0000", "#ffff00", "#00ff00", "#ff00ff"];
                for(let i=0; i<4; i++) { ctx.fillStyle = colors[i]; ctx.fillRect(this.x + 8, this.y + 55 + (i*4), 24, 4); }
                ctx.fillStyle = skin; ctx.fillRect(this.x + 6, this.y + 70, 12, 20); ctx.fillRect(this.x + 22, this.y + 70, 12, 20);
                ctx.fillStyle = "#333"; ctx.fillRect(this.x + 4, this.y + 88, 14, 5); ctx.fillRect(this.x + 22, this.y + 88, 14, 5);
            }
        };

        const enemy = { 
            x: 600, y: 50, w: 70, h: 35, dir: 1, health: 100, alive: true,
            draw() {
                if(!this.alive) return;
                ctx.fillStyle = "#333"; ctx.fillRect(this.x, this.y, this.w, this.h);
                if(frames % 120 < 100) {
                    ctx.fillStyle = "white"; ctx.fillRect(this.x + 25, this.y + 10, 20, 15);
                    ctx.fillStyle = "red"; ctx.fillRect(this.x + 32, this.y + 15, 6, 6);
                }
                ctx.fillStyle = "black"; ctx.fillRect(this.x, this.y - 10, this.w, 5);
                ctx.fillStyle = "red"; ctx.fillRect(this.x, this.y - 10, (this.health/100)*this.w, 5);
            }
        };

        const obstacles = [];
        const deivePowers = [];
        const enemyAttacks = [];

        function drawHUD() {
            // Barra de fundo do HUD
            ctx.fillStyle = "rgba(0, 0, 0, 0.5)";
            ctx.fillRect(0, 0, canvas.width, 40);

            ctx.fillStyle = "white";
            ctx.font = "bold 18px Arial";
            ctx.textAlign = "left";

            // Tempo para o prÃ³ximo evento
            ctx.fillStyle = "#00d4ff";
            ctx.fillText(`â±ï¸ EVENTO EM: ${timeRemaining}s`, 20, 27);

            // Contador de Mortes
            ctx.fillStyle = "#ff4757";
            ctx.fillText(`ðŸ’€ MORTES: ${kills}/3`, 320, 27);

            // PontuaÃ§Ã£o
            ctx.fillStyle = "#ffeb3b";
            ctx.textAlign = "right";
            ctx.fillText(`â­ PONTOS: ${score}`, canvas.width - 20, 27);
        }

        function update() {
            if (!gameActive) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (frames % 60 === 0) {
                timeRemaining--;
                if (timeRemaining < 0) {
                    flightMode = !flightMode;
                    timeRemaining = 10;
                    obstacles.length = 0;
                    canvas.style.backgroundColor = flightMode ? "#00BFFF" : "#4682B4";
                }
            }

            if (enemy.alive) {
                enemy.x += 4 * enemy.dir;
                if (enemy.x > 700 || enemy.x < 100) enemy.dir *= -1;
                enemy.draw();
                if (frames % 120 === 101) {
                    enemyAttacks.push({ x: enemy.x + 35, y: enemy.y + 35, vx: -7, vy: (deive.y - enemy.y)/40 });
                }
            } else if (frames % 120 === 0) { enemy.alive = true; enemy.health = 100; }

            if (flightMode) {
                if (moveState.Up) deive.y -= deive.speed;
                if (moveState.Down) deive.y += deive.speed;
                if (moveState.Left) deive.x -= deive.speed;
                if (moveState.Right) deive.x += deive.speed;
                deive.y = Math.max(40, Math.min(canvas.height - 90, deive.y));
                deive.x = Math.max(0, Math.min(canvas.width - 40, deive.x));
            } else {
                deive.dy += deive.gravity;
                deive.y += deive.dy;
                if (deive.y > 300) { deive.y = 300; deive.dy = 0; deive.grounded = true; }
            }
            deive.draw();

            if (!flightMode && frames % 100 === 0) obstacles.push({ x: canvas.width, y: 330, w: 30, h: 60 });
            obstacles.forEach((o, i) => {
                o.x -= 6; ctx.fillStyle = "black"; ctx.fillRect(o.x, o.y, o.w, o.h);
                if (deive.x < o.x + o.w && deive.x + deive.width > o.x && deive.y < o.y + o.h && deive.y + deive.height > o.y) gameOver();
                if (o.x < -30) obstacles.splice(i, 1);
            });

            enemyAttacks.forEach((a, i) => {
                a.x += a.vx; a.y += a.vy;
                ctx.fillStyle = "#ff00ff"; ctx.beginPath(); ctx.arc(a.x, a.y, 10, 0, Math.PI*2); ctx.fill();
                if (a.x > deive.x && a.x < deive.x + deive.width && a.y > deive.y && a.y < deive.y + deive.height) gameOver();
                if (a.x < 0) enemyAttacks.splice(i, 1);
            });

            deivePowers.forEach((p, i) => {
                p.x += 12; ctx.fillStyle = "#00ffff"; ctx.fillRect(p.x, p.y, 20, 6);
                if (enemy.alive && p.x > enemy.x && p.x < enemy.x + enemy.w && p.y > enemy.y && p.y < enemy.y + enemy.h) {
                    deivePowers.splice(i, 1); enemy.health -= 25;
                    if (enemy.health <= 0) { 
                        enemy.alive = false; kills++; score += 500;
                        if (kills >= 3) showVictory();
                    }
                }
                if (p.x > canvas.width) deivePowers.splice(i, 1);
            });

            drawHUD();
            frames++;
            requestAnimationFrame(update);
        }

        function showVictory() {
            gameActive = false; gameWon = true;
            ctx.fillStyle = "rgba(0,0,0,0.9)"; ctx.fillRect(0,0,canvas.width, canvas.height);
            ctx.fillStyle = "#ffd700"; ctx.textAlign = "center"; ctx.font = "bold 35px Arial";
            ctx.fillText("PARABÃ‰NS,", canvas.width/2, canvas.height/2 - 20);
            ctx.fillText("DEIVE ABRAÃƒO", canvas.width/2, canvas.height/2 + 30);
        }

        function gameOver() {
            gameActive = false;
            ctx.fillStyle = "rgba(0,0,0,0.8)"; ctx.fillRect(0,0,canvas.width, canvas.height);
            ctx.fillStyle = "white"; ctx.textAlign = "center"; ctx.font = "bold 25px Arial";
            ctx.fillText("FIM DE JOGO", canvas.width/2, canvas.height/2);
            ctx.font = "16px Arial"; ctx.fillText("Toque em REINICIAR", canvas.width/2, canvas.height/2 + 40);
        }

        function setupButton(id, action) {
            const el = document.getElementById(id);
            const start = (e) => {
                e.preventDefault();
                if (action === 'Jump') {
                    if (gameActive && deive.grounded && !flightMode) { deive.dy = -deive.jumpForce; deive.grounded = false; }
                    else if (!gameActive) location.reload();
                } else if (action === 'Shoot') {
                    if (flightMode && gameActive) deivePowers.push({ x: deive.x + 40, y: deive.y + 40 });
                } else moveState[action] = true;
            };
            const end = (e) => {
                e.preventDefault();
                if (action !== 'Jump' && action !== 'Shoot') moveState[action] = false;
            };
            el.addEventListener('touchstart', start, {passive: false});
            el.addEventListener('touchend', end, {passive: false});
            el.addEventListener('mousedown', start);
            el.addEventListener('mouseup', end);
        }

        setupButton('btnJump', 'Jump');
        setupButton('btnUp', 'Up');
        setupButton('btnDown', 'Down');
        setupButton('btnLeft', 'Left');
        setupButton('btnRight', 'Right');
        setupButton('btnShoot', 'Shoot');

        update();
    </script>
</body>
</html>